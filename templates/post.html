{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
<div class="question-container">
    <h1 class="question-title">{{ question.title }}</h1>
    <div class="question-content">
        <div class="question-author">
            <img src="{{ question.author.profile.avatar_url }}" alt="Avatar" class="avatar">
            <span class="author-name">{{ question.author.username }}</span>
        </div>
        <div class="question-text">
            {{ question.text }}
        </div>
        <div class="question-meta">
            <div class="likes">
                <button class="like-button" data-question-id="{{ question.id }}" data-action="like">üëç</button>
                <span class="count">{{ question.likes.count }}</span>
            </div>
            <div class="tags">
                {% for tag in question.tags.all %}
                    <a href="{% url 'tag_questions' tag.name %}" class="tag">{{ tag.name }}</a>
                {% empty %}
                    <span class="tag">No tags</span>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="answers-container">
        <h2 class="answers-title">Answers ({{ question.answers.count }})</h2>
        {% for answer in answers %}
            <div class="answer">
                <div class="answer-author">
                    <img src="{{ answer.author.profile.avatar_url }}" alt="Avatar" class="avatar">
                    <span class="author-name">{{ answer.author.username }}</span>
                </div>
                <div class="answer-text">
                    {{ answer.text }}
                </div>
                <div class="answer-likes">
                    <button class="like-answer-button" data-answer-id="{{ answer.id }}" data-action="like">üëç</button>
                    <span class="count">{{ answer.likes.count }}</span>
                </div>
                {% if question.author == request.user %}
                    <button class="correct-answer-button" data-question-id="{{ question.id }}" data-answer-id="{{ answer.id }}">‚úÖ</button>
                {% endif %}
            </div>
        {% empty %}
            <p class="no-answers">No answers yet. Be the first to answer!</p>
        {% endfor %}
    </div>

    <div class="add-answer">
        <h2>Add an Answer</h2>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="submit-button">Submit</button>
        </form>
    </div>
</div>
{% endblock %}